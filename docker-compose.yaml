services:
  frontend:
    container_name: frontend
    restart: on-failure
    build:
      context: frontend
    ports:
      - "443:443"
    volumes:
      - public:/srv/app/public
      - secrets:/run/secrets:ro
  backend:
    container_name: backend
    restart: on-failure
    build:
      context: backend
    volumes:
      - secrets:/run/secrets:ro

volumes:
  public:
    driver: local
    driver_opts:
      device: ./frontend/public
      type: none
      o: bind
  secrets:
    driver: local
    driver_opts:
      device: ./secrets
      type: none
      o: bind
